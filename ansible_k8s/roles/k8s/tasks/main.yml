---

- name: create directory to save rpm package
  shell: mkdir -p /tmp/rpm

- name: copy docker-ce rpm package
  copy: src={{role_path}}/../../pre-env/k8s-{{kubernetesVersion}} dest=/tmp/rpm

- name: mv /tmp/rpm/k8s-{{kubernetesVersion}} to /tmp/rpm/k8s
  command: mv /tmp/rpm/k8s-{{kubernetesVersion}} /tmp/rpm/k8s

- name: copy repo k8s.repo file to /etc/yum.repos.d
  copy: src={{role_path}}/files/k8s.repo dest=/etc/yum.repos.d/ owner=root group=root

- name: install kubelet kubeadm kubectl
  yum: name=kubelet,kubeadm,kubectl state=latest

- name: systemctl daemon-reload
  shell: systemctl daemon-reload

- name: systemctl start kubelet && systemctl start kubelet
  shell: systemctl start kubelet && systemctl enable kubelet
